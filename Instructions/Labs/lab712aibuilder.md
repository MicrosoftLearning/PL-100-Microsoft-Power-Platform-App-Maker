# Lab 2: Use AI Builder actions in Power Automate

In this lab, you'll create a simple flow that uses AI Builder actions to analyze the sentiment of feedback text submitted in a Microsoft Excel spreadsheet.

### Create a manual flow with AI Builder actions

Follow these steps to add AI Builder actions in a flow.

1. Sign in to Power Automate at `https://make.powerautomate.com`.

1. Select **Create** on the left navigation.

1. Select **Instant cloud flow**.

1. Select **Manually trigger a flow**.

1. Select **Create**.

1. Select **Manually trigger a flow** to edit the flow's trigger.

1. Select **Add an input**.

1. Select **Text**.

1. Name your input **Feedback**

1. Select **+ New step**. You'll now add an AI Builder action.

1. In the search field, enter "Analyze sentiment".

1. Select **Analyze positive or negative sentiment** in text

1. Select **Start trial** in the pop-up to start an AI Builder trial.

1. In the **Language** field, select **English** as the language.

1. In the **Text** field, select **Feedback**, from the list of Dynamic content.

1. Select **Save.** Your flow is now saved with an autogenerated name. You can change it by selecting the generated name on the upper-left corner of the flow designer screen. Name your flow **Analyze Feedback sentiment**.

### Use the model's inference

For this exercise, you'll use a Microsoft Excel file in OneDrive to store the text sentiment that is detected by the AI model.

1. In a new tab, sign in to [OneDrive](https://onedrive.microsoft.com) with your provided credentials.

1. If prompted, select **Your OneDrive is ready**.

1. Select **Add new** > **Excel Workbbook**.

1. Highlight cells A1:B2 and select **Insert** > **Table**

1. Check **My table has headers** and select **OK**. You should now have a table with two columns.

1. Select **File** > **Rename** and name your file **Feedback results**.

### Complete your flow

Follow these steps to use the Excel file you created in your flow.

1. In your **Analyze feedback sentiment** flow, select **+ New step** and then add the **Add a row into a table** action from Excel Online (Business).

1. In **Location**, select **OneDrive for Business**.

1. In **Document Library**, select **OneDrive**.

1. In the **File** field, select the picker icon and select your **Feedback results.xlsx** file.

1. In the **Table** field, select the name of the table that you created in your Excel file (it is likely named Table1).

1. In the **Column1** field, add **Feedback** from the Dynamic content list

1. In the **Column2** field, add **Overall text sentiment**.

1. Select **Save** to save your flow.

### Test the flow

Let's test your flow by analyzing text in the Excel file. 

1. Select **Test** on the upper-right corner of the flow designer screen.

1. Select **Manually** and the select **Test**.

1. Select **Continue** if prompted with the Sign in pane. 

1. Provide the value of the **Feedback** field from the trigger action. This text is what you want to analyze the sentiment for. For this example, we'll enter *This app was really easy to use and gave me great results.*

1. Select **Done** to watch your flow run. If your flow ran successfully, you will see all steps shown with a green checkmark.

1. You can expand the actions to view the running inputs and outputs of each action, which is a good way to debug your flow.

1. Navigate to your Excel file and check that the line of feedback and sentiment was added.

Congratulations, you've successfully created your first AI Builder flow.
